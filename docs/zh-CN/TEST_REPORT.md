# @dreamer/crypto 测试报告

## 测试概览

| 项目         | 值                  |
| ------------ | ------------------- |
| **库版本**   | 1.0.0-beta.2        |
| **测试框架** | @dreamer/test       |
| **测试日期** | 2026-02-06          |
| **测试环境** | Deno 2.5+，Bun 1.0+ |
| **测试文件** | tests/mod.test.ts   |
| **总用例数** | 70                  |
| **通过**     | 70                  |
| **失败**     | 0                   |
| **通过率**   | 100%                |
| **执行时间** | ~5s                 |

---

## 测试结果摘要

全部 70 条用例通过。覆盖范围包括：

- 哈希（SHA1、SHA256、SHA512）
- 哈希验证
- 随机数生成（字节、字符串、整数、UUID）
- AES 密钥生成与导入
- 对称加密/解密（AES-GCM、AES-CBC）
- RSA 密钥对生成
- ECDSA 密钥对生成
- RSA 加密/解密
- 数字签名（RSA、ECDSA）
- JWT（签发、验证、解码）

---

## 详细测试结果

### 1. hash（7 条）

| 用例                   | 状态    |
| ---------------------- | ------- |
| 应计算 SHA1 哈希       | ✅ 通过 |
| 应计算 SHA256 哈希     | ✅ 通过 |
| 应计算 SHA512 哈希     | ✅ 通过 |
| 应默认使用 SHA256      | ✅ 通过 |
| 相同输入应得到相同哈希 | ✅ 通过 |
| 不同输入应得到不同哈希 | ✅ 通过 |
| 应拒绝 MD5 算法        | ✅ 通过 |

### 2. verifyHash（3 条）

| 用例                 | 状态    |
| -------------------- | ------- |
| 应验证正确哈希       | ✅ 通过 |
| 应拒绝错误哈希       | ✅ 通过 |
| 应验证不同算法的哈希 | ✅ 通过 |

### 3. generateRandomBytes（2 条）

| 用例                   | 状态    |
| ---------------------- | ------- |
| 应生成指定长度随机字节 | ✅ 通过 |
| 应生成不同的随机字节   | ✅ 通过 |

### 4. generateRandomString（4 条）

| 用例                     | 状态    |
| ------------------------ | ------- |
| 应生成指定长度随机字符串 | ✅ 通过 |
| 应使用默认字符集         | ✅ 通过 |
| 应使用自定义字符集       | ✅ 通过 |
| 应生成不同随机字符串     | ✅ 通过 |

### 5. generateRandomInt（2 条）

| 用例                 | 状态    |
| -------------------- | ------- |
| 应生成范围内随机整数 | ✅ 通过 |
| 应生成不同随机整数   | ✅ 通过 |

### 6. generateUUID（2 条）

| 用例               | 状态    |
| ------------------ | ------- |
| 应生成有效 UUID v4 | ✅ 通过 |
| 应生成不同 UUID    | ✅ 通过 |

### 7. generateKey（2 条）

| 用例                | 状态    |
| ------------------- | ------- |
| 应生成 AES-128 密钥 | ✅ 通过 |
| 应生成 AES-256 密钥 | ✅ 通过 |

### 8. importAESKey（4 条）

| 用例                          | 状态    |
| ----------------------------- | ------- |
| 应从字节导入 AES-256-GCM 密钥 | ✅ 通过 |
| 应从字节导入 AES-128-GCM 密钥 | ✅ 通过 |
| 应从字节导入 AES-256-CBC 密钥 | ✅ 通过 |
| 应从字节导入 AES-128-CBC 密钥 | ✅ 通过 |

### 9. encrypt/decrypt（7 条）

| 用例                           | 状态    |
| ------------------------------ | ------- |
| 应使用 AES-256-GCM 加密并解密  | ✅ 通过 |
| 应使用 AES-128-GCM 加密并解密  | ✅ 通过 |
| 应使用 AES-256-CBC 加密并解密  | ✅ 通过 |
| 应使用 AES-128-CBC 加密并解密  | ✅ 通过 |
| 应使用 Uint8Array 密钥加密解密 | ✅ 通过 |
| 应拒绝错误密钥解密             | ✅ 通过 |
| 应拒绝错误算法解密             | ✅ 通过 |

### 10. generateRSAKeyPair（2 条）

| 用例                           | 状态    |
| ------------------------------ | ------- |
| 应生成 RSA 密钥对（默认 2048） | ✅ 通过 |
| 应生成指定模长的 RSA 密钥对    | ✅ 通过 |

### 11. generateECDSAKeyPair（4 条）

| 用例                      | 状态    |
| ------------------------- | ------- |
| 应生成 P-256 ECDSA 密钥对 | ✅ 通过 |
| 应生成 P-384 ECDSA 密钥对 | ✅ 通过 |
| 应生成 P-521 ECDSA 密钥对 | ✅ 通过 |
| 应默认使用 P-256          | ✅ 通过 |

### 12. encryptRSA/decryptRSA（2 条）

| 用例                       | 状态    |
| -------------------------- | ------- |
| 应使用 RSA-OAEP 加密并解密 | ✅ 通过 |
| 应拒绝错误私钥解密         | ✅ 通过 |

### 13. sign/verify - RSA（5 条）

| 用例                         | 状态    |
| ---------------------------- | ------- |
| 应使用 RSA-SHA256 签名并验证 | ✅ 通过 |
| 应使用 RSA-SHA384 签名并验证 | ✅ 通过 |
| 应使用 RSA-SHA512 签名并验证 | ✅ 通过 |
| 应拒绝错误签名               | ✅ 通过 |
| 应拒绝错误公钥验证           | ✅ 通过 |

### 14. sign/verify - ECDSA（3 条）

| 用例                           | 状态    |
| ------------------------------ | ------- |
| 应使用 ECDSA-SHA256 签名并验证 | ✅ 通过 |
| 应使用 ECDSA-SHA384 签名并验证 | ✅ 通过 |
| 应拒绝错误签名                 | ✅ 通过 |

### 15. JWT - signJWT（10 条）

| 用例                      | 状态    |
| ------------------------- | ------- |
| 应使用 HS256 生成 JWT     | ✅ 通过 |
| 应使用 HS384 生成 JWT     | ✅ 通过 |
| 应使用 HS512 生成 JWT     | ✅ 通过 |
| 应默认使用 HS256          | ✅ 通过 |
| 应包含过期时间            | ✅ 通过 |
| 应包含签发者              | ✅ 通过 |
| 应包含受众                | ✅ 通过 |
| 应包含主题                | ✅ 通过 |
| 应使用 RSA 密钥生成 JWT   | ✅ 通过 |
| 应使用 ECDSA 密钥生成 JWT | ✅ 通过 |

### 16. JWT - verifyJWT（9 条）

| 用例                    | 状态    |
| ----------------------- | ------- |
| 应验证有效 HS256 JWT    | ✅ 通过 |
| 应验证有效 HS384 JWT    | ✅ 通过 |
| 应验证有效 HS512 JWT    | ✅ 通过 |
| 应拒绝错误密钥          | ✅ 通过 |
| 应拒绝无效 token 格式   | ✅ 通过 |
| 应拒绝已过期 token      | ✅ 通过 |
| 应拒绝尚未生效 token    | ✅ 通过 |
| 应验证 RSA 签名的 JWT   | ✅ 通过 |
| 应验证 ECDSA 签名的 JWT | ✅ 通过 |

### 17. JWT - decodeJWT（2 条）

| 用例                  | 状态    |
| --------------------- | ------- |
| 应解码 JWT token      | ✅ 通过 |
| 应拒绝无效 token 格式 | ✅ 通过 |

---

## API 覆盖

| API                                         | 覆盖    |
| ------------------------------------------- | ------- |
| `hash()`                                    | ✅ 完整 |
| `verifyHash()`                              | ✅ 完整 |
| `generateRandomBytes()`                     | ✅ 完整 |
| `generateRandomString()`                    | ✅ 完整 |
| `generateRandomInt()`                       | ✅ 完整 |
| `generateUUID()`                            | ✅ 完整 |
| `generateKey()`                             | ✅ 完整 |
| `importAESKey()`                            | ✅ 完整 |
| `encrypt()` / `decrypt()`                   | ✅ 完整 |
| `generateRSAKeyPair()`                      | ✅ 完整 |
| `generateECDSAKeyPair()`                    | ✅ 完整 |
| `encryptRSA()` / `decryptRSA()`             | ✅ 完整 |
| `sign()` / `verify()`                       | ✅ 完整 |
| `signJWT()` / `verifyJWT()` / `decodeJWT()` | ✅ 完整 |

---

## 边界与安全

| 场景          | 覆盖 |
| ------------- | ---- |
| 拒绝 MD5      | ✅   |
| 错误密钥解密  | ✅   |
| 错误算法解密  | ✅   |
| 无效 JWT 格式 | ✅   |
| 过期 JWT      | ✅   |
| 尚未生效 JWT  | ✅   |
| 错误签名      | ✅   |
| 错误公钥验证  | ✅   |

---

## 结论

全部 70 条用例通过（通过率 100%）。本库覆盖哈希、对称/非对称加密、数字签名、JWT
与随机数生成，并对安全相关边界情况进行了测试。适用于生产环境。

---

**报告生成日期**：2026-02-06\
**环境**：Deno 2.5+，Bun 1.0+\
**框架**：@dreamer/test
